{"version":3,"file":"CANBusGenerator.js","sourceRoot":"","sources":["../../src/bl/CANBusGenerator.ts"],"names":[],"mappings":";;AAAA,6DAAoD;AAEpD,oDAAiD;AACjD,2CAA2D;AAQ3D,MAAqB,eAAe;IAApC;QAuBE,iBAAY,GAAG,GAAY,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC;IAClD,CAAC;IArBS,aAAa,CAAC,gBAAgB;QAClC,MAAM,KAAK,GAAW,kBAAU,CAAC,IAAI,uBAAU,EAAE,CAAC,CAAC;QAEnD,gBAAgB,CAAC,KAAK,CAAC,CAAC;IAC5B,CAAC;IAED,KAAK,CAAC,gBAAgB;QACpB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,UAAU,GAAG,6BAAiB,CAAC,GAAG,EAAE,CACvC,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;SACjD;IACH,CAAC;IAED,IAAI;QACF,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;YACxB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;SACxB;IACH,CAAC;CAGF;AAxBD,kCAwBC","sourcesContent":["import setRandomInterval from \"set-random-interval\";\r\nimport { Events, Log } from \"../model/Log\";\r\nimport { CANMessage } from \"../model/CANMessage\";\r\nimport { canEncoder, randomNumber } from \"../common/utils\";\r\n\r\n/*\r\n  CANGenerator generates CAN protocol frame every 50~100 milliseconds,\r\n  and send it to the callback function that the\r\n  father component provides.\r\n*/\r\n\r\nexport default class CANBusGenerator {\r\n  private intervalID;\r\n\r\n  private generateFrame(onFrameGenerated) {\r\n      const frame: string = canEncoder(new CANMessage());\r\n\r\n      onFrameGenerated(frame);\r\n  }\r\n\r\n  start(onFrameGenerated): void {\r\n    if (!this.intervalID) {\r\n      this.intervalID = setRandomInterval(() =>\r\n        this.generateFrame(onFrameGenerated), 0, 100);\r\n    }\r\n  }\r\n\r\n  stop(): void {\r\n    if (this.intervalID) {\r\n      this.intervalID.clear();\r\n      this.intervalID = null;\r\n    }\r\n  }\r\n\r\n  isGenerating = (): boolean => !!this.intervalID;\r\n}\r\n"]}